*   AUTORIZACION DE CLAVES
*
DEFI WIND WPASS FROM 10,25 TO 12,51 COLOR SCHEME 4
ACTI WIND WPASS

SELECT 0
USE PASSWORD
SET FILTER TO NIVEL >= 6
GO TOP
X = 0
DO WHILE .T.
   IF X >= 2
      SW=4
      EXIT
*      CLOSE DATA
*      QUIT
   ENDIF   
   STORE SPACE(10) TO ZCR5678L
   @0,0  SAY 'Teclee Clave: ' GET ZCR5678L PICT '9999999999' COLOR 6,8/8
   READ
   DO ARMA
   GO TOP
   DO WHILE .NOT. EOF()
      IF ZCR5678L = CR5678L
         YFIRMA = USUARIO
         IF FFFFFF-FECHAF > 25
            WAIT ' DEBE CAMBIAR SU CLAVE PERIODO DE VIGENCIA SE TERMINO ' WIND
            ZCR5678L = 'XXX'
         ENDIF   
         EXIT
      ENDIF   
      SKIP
   ENDDO
   IF ZCR5678L = CR5678L
      EXIT
   ENDIF   
   WAIT ' PASSWORD INCORRECTO NO TIENE DERECHO A ESTA OPCION  ' WIND
   X = X + 1
   LOOP
ENDDO      
USE
DEACT WIND WPASS
RETURN

PROCEDURE ARMA 

   V1=SUBSTR(ZCR5678L,1,1)
   C1=ALLTRIM(STR(VAL(V1)*9))
   P1=STR(ASC(C1),2)
   
   V2=SUBSTR(ZCR5678L,1,1)
   C2=ALLTRIM(STR(VAL(V2)*7))
   P2=STR(ASC(C2),2)
 
   V3=SUBSTR(ZCR5678L,1,1)
   C3=ALLTRIM(STR(VAL(V3)))
   P3=STR(ASC(C3),2)
   
   V4=SUBSTR(ZCR5678L,2,1)
   C4=ALLTRIM(STR(VAL(V4)*9))
   P4=STR(ASC(C4),2)
   
   V5=SUBSTR(ZCR5678L,2,1)
   C5=ALLTRIM(STR(VAL(V5)*7))
   P5=STR(ASC(C5),2)
 
   V6=SUBSTR(ZCR5678L,2,1)
   C6=ALLTRIM(STR(VAL(V6)))
   P6=STR(ASC(C6),2)

   V7=SUBSTR(ZCR5678L,3,1)
   C7=ALLTRIM(STR(VAL(V7)*9))
   P7=STR(ASC(C7),2)
   
   V8=SUBSTR(ZCR5678L,3,1)
   C8=ALLTRIM(STR(VAL(V8)*7))
   P8=STR(ASC(C8),2)
 
   V9=SUBSTR(ZCR5678L,3,1)
   C9=ALLTRIM(STR(VAL(V9)))
   P9=STR(ASC(C9),2)

   V0=SUBSTR(ZCR5678L,4,1)
   C0=ALLTRIM(STR(VAL(V0)*9))
   P0=STR(ASC(C0),2)
   
   V11=SUBSTR(ZCR5678L,4,1)
   C11=ALLTRIM(STR(VAL(V11)*7))
   P11=STR(ASC(C11),2)
 
   V12=SUBSTR(ZCR5678L,4,1)
   C12=ALLTRIM(STR(VAL(V12)))
   P12=STR(ASC(C12),2)

   V13=SUBSTR(ZCR5678L,5,1)
   C13=ALLTRIM(STR(VAL(V13)*9))
   P13=STR(ASC(C13),2)
   
   V14=SUBSTR(ZCR5678L,5,1)
   C14=ALLTRIM(STR(VAL(V14)*7))
   P14=STR(ASC(C14),2)
 
   V15=SUBSTR(ZCR5678L,5,1)
   C15=ALLTRIM(STR(VAL(V15)))
   P15=STR(ASC(C15),2)

   V16=SUBSTR(ZCR5678L,6,1)
   C16=ALLTRIM(STR(VAL(V16)*9))
   P16=STR(ASC(C16),2)
   
   V17=SUBSTR(ZCR5678L,6,1)
   C17=ALLTRIM(STR(VAL(V17)*7))
   P17=STR(ASC(C17),2)
 
   V18=SUBSTR(ZCR5678L,6,1)
   C18=ALLTRIM(STR(VAL(V18)))
   P18=STR(ASC(C18),2)

   V19=SUBSTR(ZCR5678L,7,1)
   C19=ALLTRIM(STR(VAL(V19)*9))
   P19=STR(ASC(C19),2)
   
   V20=SUBSTR(ZCR5678L,7,1)
   C20=ALLTRIM(STR(VAL(V20)*7))
   P20=STR(ASC(C20),2)
 
   V21=SUBSTR(ZCR5678L,7,1)
   C21=ALLTRIM(STR(VAL(V21)))
   P21=STR(ASC(C21),2)


   V22=SUBSTR(ZCR5678L,8,1)
   C22=ALLTRIM(STR(VAL(V22)*9))
   P22=STR(ASC(C22),2)
   
   V23=SUBSTR(ZCR5678L,8,1)
   C23=ALLTRIM(STR(VAL(V23)*7))
   P23=STR(ASC(C23),2)
 
   V24=SUBSTR(ZCR5678L,8,1)
   C24=ALLTRIM(STR(VAL(V24)))
   P24=STR(ASC(C24),2)


   V25=SUBSTR(ZCR5678L,9,1)
   C25=ALLTRIM(STR(VAL(V25)*9))
   P25=STR(ASC(C25),2)
   
   V26=SUBSTR(ZCR5678L,9,1)
   C26=ALLTRIM(STR(VAL(V26)*7))
   P26=STR(ASC(C26),2)
 
   V27=SUBSTR(ZCR5678L,9,1)
   C27=ALLTRIM(STR(VAL(V27)))
   P27=STR(ASC(C27),2)


   V28=SUBSTR(ZCR5678L,10,1)
   C28=ALLTRIM(STR(VAL(V28)*9))
   P28=STR(ASC(C28),2)
   
   V29=SUBSTR(ZCR5678L,10,1)
   C29=ALLTRIM(STR(VAL(V29)*7))
   P29=STR(ASC(C29),2)
 
   V30=SUBSTR(ZCR5678L,10,1)
   C30=ALLTRIM(STR(VAL(V30)))
   P30=STR(ASC(C30),2)
   
*   ZCR5678L = P1+P2+P3+P4+P5+P6+P7+P8+P9+P0+P11+P12+P13+P14+P15+P16+P17+P18+P19+P20+P21+P22+P23+P24+P25+P26+P27+P28+P29+P30
   ZCR5678L = SUBSTR(P1,2,1)+SUBSTR(P2,2,1)+SUBSTR(P3,2,1)+SUBSTR(P4,2,1)+SUBSTR(P5,2,1)+SUBSTR(P6,2,1)+SUBSTR(P7,2,1)+SUBSTR(P8,2,1)+SUBSTR(P9,2,1)+SUBSTR(P0,2,1)+SUBSTR(P11,2,1)+SUBSTR(P12,2,1)+SUBSTR(P13,2,1)+SUBSTR(P14,2,1)+SUBSTR(P15,2,1)+SUBSTR(P16,2,1)+SUBSTR(P17,2,1)+SUBSTR(P18,2,1)+SUBSTR(P19,2,1)+SUBSTR(P20,2,1)+SUBSTR(P21,2,1)+SUBSTR(P22,2,1)+SUBSTR(P23,2,1)+SUBSTR(P24,2,1)+SUBSTR(P25,2,1)+SUBSTR(P26,2,1)+SUBSTR(P27,2,1)+SUBSTR(P28,2,1)+SUBSTR(P29,2,1)+SUBSTR(P30,2,1)+'                              '
   
