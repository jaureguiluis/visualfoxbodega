*    ESTE REPORTE OBTIENE EL CATALOGO DE CUENTAS
*
@ 4, 1 TO 21,78 CLEAR
@23, 1 SAY SPACE(78)
SELECT 1
USE &XPATCB\CUENTA INDEX &XPATCB\CUENTA
XTITULO = 'CATALOGO DE CUENTAS'
SINO = 'S'
XDEST = 'T'
XNIVEL = 9
XCUENTA = 0
ON KEY LABEL F1 DO BCUENTA
@5,20 SAY XTITULO
@7,10 SAY 'Teclee el Numero de Cuenta de Mayor a Imprimir  :' GET XCUENTA PICT '9999'
@9,20 SAY 'TECLEE BLANCOS SI DESEA TODAS'
@23,20 SAY '<F1> Lista          <ESC> Terminar'
READ
ON KEY LABEL F1
IF LASTKEY() = 27
   CLOSE DATABASES
   RETURN
ENDIF
SET FILTER TO
SEEK STR(XCUENTA,4)
IF EOF() .AND. XCUENTA <> 0
   WAIT 'NUMERO DE CUENTA NO EXISTE ' WIND
   CLOSE DATA
   RETURN
ENDIF
GO TOP
@23, 1 SAY SPACE(78)
@18,20 SAY 'Informacion en <I>mpresora O <T>erminal ' GET XDEST PICT '@M I,T'
@23,25 SAY '<ESC> Terminar'
READ
IF LASTKEY() = 27
   CLOSE DATABASES
   RETURN
ENDIF
@23, 1 SAY SPACE(78)
SET COLOR TO 7*
@23,20 SAY 'FAVOR DE ESPERAR UN MOMENTO ....'
SET COLOR TO &XCOLOR
NPAG  = 0
XNLPP = NLPP
N    = NLPP
IF XCUENTA <> 0
   SET FILTER TO CUENTA = XCUENTA
   GO TOP
ENDIF
IF EOF()
   CLOSE DATABASES
   RETURN
ENDIF
SET DEVICE TO PRINT
IF XDEST = 'T'
   XT=XTERMINAL+'.TXT'
   SET PRINTER TO &XT
ENDIF
??? CHR(18)
DO WHILE .NOT. EOF()
   IF N>=XNLPP
      NPAG = NPAG + 1
      @0, 1 SAY FFFFFF
      @0,70 SAY 'PAG :'
      @0,76 SAY NPAG PICT '9999'
      IF XDEST = 'I'
         ??? CHR(18)+CHR(14)
         @1,(44-LEN(XCIA))/2 SAY XCIA
         ??? CHR(15)+CHR(14)
         @2,(70-LEN(XTITULO))/2 SAY XTITULO
         ??? CHR(18)
      ELSE
         @1,20 SAY XCIA
         @2,20 SAY XTITULO
         XNLPP = 10000
      ENDIF
      @4,12 SAY 'CUENTA'
      @4,30 SAY 'D E S C R I P C I O N'
      @5, 1 SAY REPLICATE('=',80)
      N=5
   ENDIF
   N=N+1
   @N,5  SAY STR(CUENTA,4)+STR(SCUENTA,4)+STR(SSCUENTA,3)+STR(SSSCUENTA,3)
   @N,24 SAY NOMBRE
   SKIP
ENDDO
EJECT
SET DEVICE TO SCREEN
CLOSE DATABASES
IF XDEST = 'T'
   DO TERMINAL
ENDIF
RETURN
