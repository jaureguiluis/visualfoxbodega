*   menu principal del sistema de CONTABILIDAD
*
CLOSE DATABASES
SET BELL       OFF
SET CONFIRM    ON
SET DATE BRITISH
SET DELETE     ON
SET ESCAPE     OFF
SET EXACT      OFF
SET EXCLUSIVE  OFF
SET MESSAGE TO 23
SET FUNCTION 2 TO ' '
SET FUNCTION 8 TO ' '
SET HELP OFF
SET PROCEDURE TO CBPROC
SET SAFETY     OFF
SET SCOREBOARD OFF
SET STAT       OFF
SET SYSMENU    OFF
SET TALK       OFF
SET UNIQUE     OFF
SET CENTURY    ON
SET PROCEDURE TO CBPROC
ON ERROR DO ERR WITH LINENO(),PROGRAM(),MESSAGE(1)
= INSMODE(.T.)
= NUMLOCK(.T.)
= CAPSLOCK(.T.)
PUBLIC NLPP,XCIA,FFFFFF,MES,XPATCB,XCOLOR,NMES,XCAUXI,XCAUXL,XTERMINAL
STORE DATE() TO FFFFFF
DIMENSION NMES(12)
NMES(1)  = 'ENERO'
NMES(2)  = 'FEBRERO'
NMES(3)  = 'MARZO'
NMES(4)  = 'ABRIL'
NMES(5)  = 'MAYO'
NMES(6)  = 'JUNIO'
NMES(7)  = 'JULIO'
NMES(8)  = 'AGOSTO'
NMES(9)  = 'SEPTIEMBRE'
NMES(10) = 'OCTUBRE'
NMES(11) = 'NOVIEMBRE'
NMES(12) = 'DICIEMBRE'
MES = NMES(MONTH(FFFFFF))
XSIS='Sistema de Contabilidad General'
XSIS='CAPTURA DE POLIZAS'
***** DEFINICION DE VENTAS DE PANTAL *****

    DEFI WIND PANTAL FROM -1,-1 TO 25,81

    DEFI WIND ALTAC FROM 21,10 TO 24,68 DOUBLE

    DEFI WIND TERMINAL FROM 0,0 TO 22,79 TITLE 'CONSULTA EN PANTALLA'

    DEFI POPUP POPCUENTA FROM 6,15 TO 20,65 PROMPT FIELD STR(CUENTA,4)+STR(SCUENTA,4)+STR(SSCUENTA,3)+STR(SSSCUENTA,3)+' '+NOMBRE
    ON SELECTION POPUP POPCUENTA DEAC POPUP POPCUENTA

    DEFI POPUP POPEMPRESA FROM 10,20 PROMPT FIELD NOMBRET
    ON SELECTION POPUP POPEMPRESA DEAC POPUP POPEMPRESA

DEFINE MENU CBMENU
DEFINE PAD  ALTAS    OF CBMENU PROMPT '  Altas   '   AT 5,05
DEFINE PAD  REPORTES OF CBMENU PROMPT ' Reportes '   AT 5,25
DEFINE PAD  OREPORTE OF CBMENU PROMPT ' Reportes '   AT 5,45
DEFINE PAD  PROCESOS OF CBMENU PROMPT ' Procesos '   AT 5,65

ON PAD ALTAS    OF CBMENU ACTIVATE POPUP ALTAS
ON PAD REPORTES OF CBMENU ACTIVATE POPUP REPORTES
ON PAD OREPORTE OF CBMENU ACTIVATE POPUP OREPORTE
ON PAD PROCESOS OF CBMENU ACTIVATE POPUP PROCESOS

DEFINE POPUP ALTAS FROM 8,5
DEFINE BAR  1 OF ALTAS PROMPT '\<A.- ABC de Polizas      ' MESSAGE 'ALTAS BAJAS Y CAMBIOS (captura) DE POLIZAS'
DEFINE BAR  2 OF ALTAS PROMPT '\<B.- ABC de Cuentas      ' MESSAGE 'ALTAS BAJAS Y CAMBIOS A CUENTAS CONTABLES'
DEFINE BAR  3 OF ALTAS PROMPT '\<C.- Cambio de Periodo   ' MESSAGE 'MODIFICACION DEL PERIODO '
DEFINE BAR  4 OF ALTAS PROMPT '\<D.- Seleccion de empresa' MESSAGE 'SELECCIONA LA EMPRESA EN LA CUAL VA A TRABAJAR'
DEFINE BAR  5 OF ALTAS PROMPT '\<E.- ABC de Empresas     ' MESSAGE 'ALTAS BAJAS Y CAMBIOS A EMPRESAS'
DEFINE BAR  6 OF ALTAS PROMPT '\<F.- Crea Archivo P/ADCON' MESSAGE 'GENERA ARCHIVO DE INTERFASE PARA ADCON'
DEFINE BAR  7 OF ALTAS PROMPT '\<G.- Obtiene RFC Con Error' MESSAGE 'REVISA LAS POLIZAS EN BUSCA DE RFC CON ERROR'
DEFINE BAR  8 OF ALTAS PROMPT '\<H.- Genera Poliza 1      ' MESSAGE 'GENERA POLIZA 1 DE DIARIO DE VENTAS'
DEFINE BAR  9 OF ALTAS PROMPT '\<I.- Genera Poliza 2      ' MESSAGE 'GENERA POLIZA 2 DE INGRESOS FICHAS'
DEFINE BAR 10 OF ALTAS PROMPT '\<J.- Genera Poliza 1 ANTERIOR' MESSAGE 'GENERA POLIZA 1 DE DIARIO DE VENTAS'
ON SELECTION POPUP ALTAS DO CB000001


DEFINE POPUP REPORTES FROM 8,25 
DEFINE BAR  1 OF REPORTES PROMPT '\<A.- Catalogo              ' MESSAGE 'CATALAGO DE CUENTAS'
DEFINE BAR  2 OF REPORTES PROMPT '\<B.- Polizas               ' MESSAGE 'IMPRESION DE POLIZAS CONTABLES POR RANGO'
DEFINE BAR  3 OF REPORTES PROMPT '\<C.- Totales por Poliza    ' MESSAGE 'CONSULTA TOTALES POR POLIZA'
DEFINE BAR  4 OF REPORTES PROMPT '\<D.- Auxiliar              ' MESSAGE 'IMPRESION DE AUXILIARES DE CUENTAS CONTABLES'
DEFINE BAR  5 OF REPORTES PROMPT '\<E.- Balanza Comprobacion  ' MESSAGE 'IMPRESION DE BALANZA DE COMPROBACION'
*DEFINE BAR  6 OF REPORTES PROMPT '\<F.- Balance General       ' MESSAGE 'IMPRESION DE BALANCE GENERAL'
*DEFINE BAR  7 OF REPORTES PROMPT '\<G.- Estado. de Resultados ' MESSAGE 'IMPRESION DEL ESTADO DE RESULTADOS DEL PERIODO'
*DEFINE BAR  8 OF REPORTES PROMPT '\<H.- Saldos Mensuales      ' MESSAGE 'IMPRESION DE LOS SALDOS MENSUALES POR CUENTA'
DEFINE BAR  9 OF REPORTES PROMPT '\<I.- Polizas x CTA Mayor    ' MESSAGE 'IMPRESION DE POLIZAS SELECCIONANDO CUENTA DE MAYOR'
ON SELECTION POPUP REPORTES DO CB000003

DEFINE POPUP OREPORTE FROM 8,45
DEFINE BAR  1 OF OREPORTE PROMPT '\<A.- Totales Trimestre      ' MESSAGE 'IMPRESION DE LOS SALDOS MENSUALES POR CUENTA'
DEFINE BAR  2 OF OREPORTE PROMPT '\<B.- Totales Mensuales      ' MESSAGE 'IMPRESION DE LOS SALDOS MENSUALES POR CUENTA'
DEFINE BAR  3 OF OREPORTE PROMPT '\<C.- Sumas                  ' MESSAGE 'IMPRESION DE SUMAS POR CUENTA '
DEFINE BAR  4 OF OREPORTE PROMPT '\<D.- Gastos                 ' MESSAGE 'IMPRESION DE GASTOS POR PROVEEDOR'
DEFINE BAR  5 OF OREPORTE PROMPT '\<E.- Gastos x Bodega        ' MESSAGE 'IMPRESION DE GASTOS POR BODEGA'
DEFINE BAR  6 OF OREPORTE PROMPT '\<F.- Gastos / Cheques       ' MESSAGE 'IMPRESION DE GASTOS EMITIDOS EN BANCOS'
DEFINE BAR  7 OF OREPORTE PROMPT '\<G.- Gastos / Poliza        ' MESSAGE 'IMPRESION DE GASTOS POLIZA'
DEFINE BAR  8 OF OREPORTE PROMPT '\<H.- Maniobras              ' MESSAGE 'IMPRESION DE MANIOBRAS'
ON SELECTION POPUP OREPORTE DO CB000004

DEFINE POPUP PROCESOS FROM 8,55
DEFINE BAR  1 OF PROCESOS PROMPT 'MANTENIMIENTO AL SISTEMA   ' MESSAGE 'COMPACTA Y GENERA LOS ARCHIVOS DE INDICE DEL SISTEMA'
DEFINE BAR  2 OF PROCESOS PROMPT 'RESPALDO DE INFORMACION    ' MESSAGE 'RESPALDA EN DISKETTE LOS PROGRAMAS Y ARCHIVOS DEL SISTEMA [BACKUP]'
DEFINE BAR  3 OF PROCESOS PROMPT 'RECUPERACION DE INFORMACION' MESSAGE 'RECUPERA DE DISKETTE LOS PROGRAMAS Y ARCHIVOS DEL SISTEMA [RESTORE]'
DEFINE BAR  4 OF PROCESOS PROMPT 'GENERA SALDO DE LAS CUENTAS' MESSAGE 'DE LOS REGISTROS DE LAS POLIZAS GENERA EL SALDO POR CUENTA'
DEFINE BAR  5 OF PROCESOS PROMPT 'CIERRE ANUAL               ' MESSAGE 'CIERRE ANUAL DE CONTABILIDAD'
DEFINE BAR  6 OF PROCESOS PROMPT 'COMPLEMENTA CON ADSYS      ' MESSAGE 'AGREGA LOS MOVIMIENTOS QUE NO EXISTEN PARA COMPLEMENTAR'
DEFINE BAR  7 OF PROCESOS PROMPT 'AGREGA TODO LO DE ADSYS    ' MESSAGE 'AGREGA TODOS LOS MOVIMIENTOS DE LA CONTABILIDAD DE ADSYS'

ON SELECTION POPUP PROCESOS DO CB000005

CLEAR
DO CB010004
IF ISCOLOR()
   SET COLOR TO &XCOLOR
ENDIF
SET CLOCK TO 1,2
DO WHILE .T.
   CLEAR
   @00,0 TO 22,79 DOUBLE
   @03,1 TO 03,78 DOUBLE
   @ 2,(78-LEN(XCIA))/2 SAY XCIA
   @ 1,55 SAY STR(DAY(FFFFFF),2)+' DE '+MES+' DE '+STR(YEAR(FFFFFF),4)
   @ 1,20  SAY XSIS
   @4,1  SAY '°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°'
   @5,1  SAY '°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°'
   @6,1  SAY 'ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ'
   @7,1  SAY '°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°'
   @8,1  SAY '°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°'
   @9,1  SAY '°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°'
   @10,1 SAY '°°°°ÛÛÛÛÛ°ÛÛÛÛÛ°Û°°°Û°ÛÛÛÛÛ°ÛÛÛÛÛ°Û°°°°°ÛÛÛÛÛ°Û°°°°°ÛÛÛÛÛ°°°°°Û°ÛÛÛÛÛ°°°°°Û°°°'
   @11,1 SAY '°°°°ÛÛÛÛÛ°ÛÛÛÛÛ°Û°°°Û°ÛÛÛÛÛ°ÛÛÛÛÛ°Û°°°°°ÛÛÛÛÛ°Û°°°°°ÛÛÛÛÛ°°°°°Û°ÛÛÛÛÛ°°°°°Û°°°'
   @12,1 SAY '°°°°Û°°°°°Û°°°Û°ÛÛ°°Û°°°Û°°°Û°°°Û°Û°°°°°°°Û°°°Û°°°°°°°Û°°°°°°°Û°Û°°°Û°°°°°Û°°°'
   @13,1 SAY '°°°°Û°°°°°Û°°°Û°ÛÛ°°Û°°°Û°°°Û°°°Û°Û°°°°°°°Û°°°Û°°°°°°°Û°°°°°°°Û°Û°°°Û°°°°°Û°°°'
   @14,1 SAY '°°°°Û°°°°°Û°°°Û°Û°Û°Û°°°Û°°°ÛÛÛÛÛ°ÛÛÛÛÛ°°°Û°°°Û°°°°°°°Û°°°ÛÛÛÛÛ°ÛÛÛÛÛ°ÛÛÛÛÛ°°°'
   @15,1 SAY '°°°°Û°°°°°Û°°°Û°Û°°ÛÛ°°°Û°°°Û°°°Û°Û°°°Û°°°Û°°°Û°°°°°°°Û°°°Û°°°Û°Û°°°Û°Û°°°Û°°°'
   @16,1 SAY '°°°°Û°°°°°Û°°°Û°Û°°ÛÛ°°°Û°°°Û°°°Û°Û°°°Û°°°Û°°°Û°°°°°°°Û°°°Û°°°Û°Û°°°Û°Û°°°Û°°°'
   @17,1 SAY '°°°°ÛÛÛÛÛ°ÛÛÛÛÛ°Û°°°Û°°°Û°°°Û°°°Û°ÛÛÛÛÛ°ÛÛÛÛÛ°ÛÛÛÛÛ°ÛÛÛÛÛ°ÛÛÛÛÛ°Û°°°Û°ÛÛÛÛÛ°°°'
   @18,1 SAY '°°°°ÛÛÛÛÛ°ÛÛÛÛÛ°Û°°°Û°°°Û°°°Û°°°Û°ÛÛÛÛÛ°ÛÛÛÛÛ°ÛÛÛÛÛ°ÛÛÛÛÛ°ÛÛÛÛÛ°Û°°°Û°ÛÛÛÛÛ°°°'
   @19,1 SAY '°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°'
   @20,1 SAY '°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°'
   @21,1 SAY '°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°°'
   ACTI MENU CBMENU
*  SINO = 'N'
*  @10,15 SAY 'TECLEE  {S}  PARA CONFIRMAR SALIDA DEL SISTEMA ' GET SINO PICT '@M S,N'
*  READ
*  IF SINO = 'S'
*     CLOSE ALL
*     CLEAR
*      QUIT
      RETURN
*  ENDIF
ENDDO

PROCEDURE CB000001
   ACTI WIND PANTAL
   @00,0 TO 22,79 DOUBLE
   @03,1 TO 03,78 DOUBLE
   @ 2,(78-LEN(XCIA))/2 SAY XCIA
   @ 1,55 SAY STR(DAY(FFFFFF),2)+' DE '+MES+' DE '+STR(YEAR(FFFFFF),4)
   @ 1,20  SAY XSIS
   P=IIF(BAR()>9,STR(BAR(),2,0),'0'+STR(BAR(),1,0)) 
   USE PTRABAJO
   APPEND BLANK
   REPLACE FECHA WITH DATE(),USUARIO WITH XFIRMA,PROGRAMA WITH 'CB0100&P',HORA WITH TIME()
   DO CB0100&P  

DEAC WIND PANTAL
@ 2,1 SAY SPACE(78)
@ 2,(78-LEN(XCIA))/2 SAY XCIA
SET DATE DMY


PROCEDURE CB000003
   ACTI WIND PANTAL
   @00,0 TO 22,79 DOUBLE
   @03,1 TO 03,78 DOUBLE
   @ 2,(78-LEN(XCIA))/2 SAY XCIA
   @ 1,55 SAY STR(DAY(FFFFFF),2)+' DE '+MES+' DE '+STR(YEAR(FFFFFF),4)
   @ 1,20  SAY XSIS
   P=IIF(BAR()>9,STR(BAR(),2,0),'0'+STR(BAR(),1,0)) 
   USE PTRABAJO
   APPEND BLANK
   REPLACE FECHA WITH DATE(),USUARIO WITH XFIRMA,PROGRAMA WITH 'CB0300&P',HORA WITH TIME()
   DO CB0300&P  
   SET DATE TO DMY
   DEAC WIND PANTAL


PROCEDURE CB000004
   ACTI WIND PANTAL
   @00,0 TO 22,79 DOUBLE
   @03,1 TO 03,78 DOUBLE
   @ 2,(78-LEN(XCIA))/2 SAY XCIA
   @ 1,55 SAY STR(DAY(FFFFFF),2)+' DE '+MES+' DE '+STR(YEAR(FFFFFF),4)
   @ 1,20  SAY XSIS
   P=IIF(BAR()>9,STR(BAR(),2,0),'0'+STR(BAR(),1,0)) 
   USE PTRABAJO
   APPEND BLANK
   REPLACE FECHA WITH DATE(),USUARIO WITH XFIRMA,PROGRAMA WITH 'CB0400&P',HORA WITH TIME()
   DO CB0400&P  
DEAC WIND PANTAL





PROCEDURE CB000005
   ACTI WIND PANTAL
   @00,0 TO 22,79 DOUBLE
   @03,1 TO 03,78 DOUBLE
   @ 2,(78-LEN(XCIA))/2 SAY XCIA
   @ 1,55 SAY STR(DAY(FFFFFF),2)+' DE '+MES+' DE '+STR(YEAR(FFFFFF),4)
   @ 1,20  SAY XSIS
   P=IIF(BAR()>9,STR(BAR(),2,0),'0'+STR(BAR(),1,0)) 
   USE PTRABAJO
   APPEND BLANK
   REPLACE FECHA WITH DATE(),USUARIO WITH XFIRMA,PROGRAMA WITH 'CB0500&P',HORA WITH TIME()
   SET EXCLUSIVE ON
      DO CB0500&P  
   SET EXCLUSIVE OFF
DEAC WIND PANTAL


