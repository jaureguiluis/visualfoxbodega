*    OBTIENE SUMAS POR CUENTA
*
@ 4, 1 TO 21,78 CLEAR
@23, 1 SAY SPACE(77)
XTITULO = 'SUMAS '
XDEST   = 'T'
STORE DATE() TO XFECHAI,XFECHAF
XFECHAI = XFECHAI-DAY(XFECHAI)+1
@5,20 SAY XTITULO
@11,20 SAY 'Teclee Fecha Inicial de la Poliza : ' GET XFECHAI
@13,20 SAY 'Teclee Fecha Final de la Poliza :   ' GET XFECHAF
@19,20 SAY 'Informacion en <I>mpresora O <T>erminal ' GET XDEST PICT '@M I,T'
@23,25 SAY '<ESC> Terminar'
READ
IF LASTKEY() = 27
   RETURN
ENDIF
SET COLOR TO 7*
@20,20 SAY 'FAVOR DE ESPERAR UN MOMENTO ....'
SET COLOR TO &XCOLOR
SELECT 1
USE &XPATCB\CUENTA INDEX &XPATCB\CUENTA ALIAS CUENTA
SELECT 3
USE &XPATCB\POLIZA INDEX &XPATCB\POLIZA
SORT ON CUENTA,SCUENTA,SSCUENTA FOR FECHA >=XFECHAI .AND. FECHA <= XFECHAF TO &XARC
SELECT 3
USE &XARC
SET RELATION TO STR(CUENTA,4)+STR(SCUENTA,4) INTO CUENTA
NPAG = 0
N    = NLPP
XNLPP = NLPP
IF EOF()
   WAIT 'NO EXISTE INFORMACION ENTRE FECHAS DADAS  TECLEE RETURN' WIND
   CLOSE DATABASES
   RETURN
ENDIF
SET DEVICE TO PRINT
IF XDEST = 'T'
   XT=XTERMINAL+'.TXT'
   SET PRINTER TO &XT
ENDIF
??? CHR(15)
STORE 0 TO XCARGO,XCREDITO,XTCARGO,XTCREDITO
XTITULO = XTITULO +' DEL : '+DTOC(XFECHAI)+' AL '+DTOC(XFECHAF)
DO WHILE .NOT. EOF()
   XCUENTA = CUENTA
   DO WHILE XCUENTA = CUENTA .AND. .NOT. EOF()
      XSCUENTA = SCUENTA
      XNOMBRE = CUENTA->NOMBRE
      DO WHILE STR(XCUENTA,4)+STR(XSCUENTA,4) = STR(CUENTA,4)+STR(SCUENTA,4) .AND. .NOT. EOF()
         IF N>=XNLPP
         NPAG = NPAG + 1
         @0,4   SAY FFFFFF PICT '@E'
         @0,15  SAY TIME()
         @0,118 SAY 'PAG :'
         @0,124 SAY NPAG PICT '999'
         IF XDEST ='I'
            ??? CHR(18)+CHR(14)
            @1,(44-LEN(XCIA))/2 SAY XCIA
            ??? CHR(15)+CHR(14)
            @2,(70-LEN(XTITULO))/2 SAY XTITULO
         ELSE
            @1,20 SAY XCIA
            @2,20 SAY XTITULO
            XNLPP = 10000
         ENDIF
         ??? CHR(18)
         @4,5   SAY 'CUENTA'
         @4,20  SAY 'N O M B R E'
         @4,50  SAY '    CARGO'
         @4,65  SAY '  CREDITO'
         @5, 0 SAY REPLICATE('=',80)
         N=5
         ENDIF
         IF MOVIMIENTO = '-'
            XCREDITO = XCREDITO + VALOR
         ELSE
            XCARGO = XCARGO + VALOR
         ENDIF
         SKIP
      ENDDO
      IF XCUENTA = 1000 .OR. XCUENTA = 1110
         N = N + 1
         @N,1 SAY XCUENTA  PICT '9999'
         @N,6 SAY XSCUENTA PICT '9999'
         @N,16 SAY XNOMBRE 
         @N,50 SAY XCARGO   PICT '999,999,999.99'  FUNCTION 'Z'
         @N,65 SAY XCREDITO PICT '999,999,999.99'  FUNCTION 'Z'
         XTCARGO   = XTCARGO +XCARGO
         XTCREDITO = XTCREDITO +XCREDITO
         STORE 0 TO XCARGO,XCREDITO
      ENDIF      
   ENDDO
   IF XCUENTA <> 1000 .AND. XCUENTA <> 1110 
      N = N + 1
      @N,1 SAY XCUENTA  PICT '9999'
      @N,6 SAY XSCUENTA PICT '9999'
      @N,16 SAY XNOMBRE 
      @N,50 SAY XCARGO   PICT '999,999,999.99'  FUNCTION 'Z'
      @N,65 SAY XCREDITO PICT '999,999,999.99'  FUNCTION 'Z'
      XTCARGO   = XTCARGO +XCARGO
      XTCREDITO = XTCREDITO +XCREDITO
      STORE 0 TO XCARGO,XCREDITO
   ENDIF   
ENDDO
N = N + 1
@N,30 SAY 'TOTAL' 
@N,50 SAY XTCARGO   PICT '999,999,999.99'  FUNCTION 'Z'
@N,65 SAY XTCREDITO PICT '999,999,999.99'  FUNCTION 'Z'
EJECT
SET DEVICE TO SCREEN
CLOSE DATABASES
IF XDEST = 'T'
   DO TERMINAL
ENDIF
RETURN
