*   GENERA ARCHIVO PARA ADCON
*
@ 4,1  TO 21,78 CLEAR
@ 23,1 SAY SPACE(78)
@ 6,25 SAY 'GENERA ARCHIVO DE POLIZA PARA ADCON'
STORE DATE() TO XFECHAI,XFECHAF
XFECHAI = XFECHAI-DAY(XFECHAI)+1
XPOLIZA = 0
@10,20 SAY 'Teclee Fecha Inicial de Poliza :    ' GET XFECHAI
@12,20 SAY 'Teclee Fecha Final de  Poliza :     ' GET XFECHAF
@14,20 SAY 'Teclee Numero de Poliza :           ' GET XPOLIZA PICT "999"
@15,20 SAY '             0 Si desea todas ' 
@23,25 SAY '<ESC> Terminar'
READ
IF LASTKEY() = 27
   RETURN
ENDIF
DIMENSION NMESS(12)
NMESS(1)  = 'EN'
NMESS(2)  = 'FE'
NMESS(3)  = 'MA'
NMESS(4)  = 'AB'
NMESS(5)  = 'MY'
NMESS(6)  = 'JU'
NMESS(7)  = 'JL'
NMESS(8)  = 'AG'
NMESS(9)  = 'SE'
NMESS(10) = 'OC'
NMESS(11) = 'NO'
NMESS(12) = 'DI'


   USE &XPATCB\INTERFASE 
   COPY STRUC TO &XTERMINAL
   USE &XTERMINAL
*   APPEND FROM &XPATCB\POLIZA FOR FECHA =XFECHAI .AND. POLIZA = XPOLIZAI .AND. TIPO = XTIPO
   IF XPOLIZA = 0
      APPEND FROM &XPATCB\POLIZA FOR FECHA >=XFECHAI .AND. FECHA <= XFECHAF 
   ELSE   
      APPEND FROM &XPATCB\POLIZA FOR FECHA >=XFECHAI .AND. FECHA <= XFECHAF .AND. POLIZA = XPOLIZA
   ENDIF   
   SET FILTER TO MOVIMIENTO = '-'
   REPLACE ALL VALOR WITH VALOR * -1
   SET FILTER TO TIPO = 'D'
   REPLACE ALL TIPO  WITH 'd'
   SET FILTER TO TIPO = 'I'
   REPLACE ALL TIPO  WITH 'i'
   SET FILTER TO TIPO = 'E'
   REPLACE ALL TIPO  WITH 'e'
   SET FILTER TO TIPO = 'O'
   REPLACE ALL TIPO  WITH 'o'
   SET FILTER TO CUENTA = 1150 
   REPLACE ALL CONCEPTO WITH ARTICULO+CONCEPTO
   SET FILTER TO CUENTA = 1130  .AND. ARTICULO <> "  "
   REPLACE ALL CONCEPTO WITH ARTICULO+CONCEPTO
   SET FILTER TO CUENTA = 1135  .AND. ARTICULO <> "  "
   REPLACE ALL CONCEPTO WITH ARTICULO+CONCEPTO
   SET FILTER TO 
   USE &XPATCB\INTERADC EXCL
   ZAP
   APPEND FROM &XTERMINAL
   IF DAY(XFECHAF) < 10
      XDIA = '0'+STR(DAY(XFECHAF),1)
   ELSE   
      XDIA = STR(DAY(XFECHAF),2)
   ENDIF   
   XMES = SUBSTR(NMESS(MONTH(XFECHAF)),1,2)
   XMES = NMESS(MONTH(XFECHAF))
   XTIPO ='3'
   XEMPRESA = SUBSTR(PATCB,2,2) 
   XINTERFASE = 'NO SE GENERO ARCHIVO DEL DIA '+XDIA
   IF XEMPRESA = '4A'
     XINTERFASE = '\ADSYS\ADCON\L\CON'+XMES+XTIPO+XDIA+'.TXT'
   ENDIF   
   IF XEMPRESA = '8F'
      XINTERFASE = '\ADSYS\ADCON\C\CON'+XMES+XTIPO+XDIA+'.TXT'
   ENDIF   
   IF XEMPRESA = '3F'
      XINTERFASE = '\ADSYS\ADCON\F\CON'+XMES+XTIPO+XDIA+'.TXT'
   ENDIF   
   IF XEMPRESA = '3L'
      XINTERFASE = '\ADSYS\ADCON\G\CON'+XMES+XTIPO+XDIA+'.TXT'
   ENDIF   
   IF XEMPRESA = '6F'
      XINTERFASE = '\ADSYS\ADCON\Z\CON'+XMES+XTIPO+XDIA+'.TXT'
   ENDIF

   IF XEMPRESA = '4S'
     XINTERFASE = '\ADSYS\ADCON\S\CON'+XMES+XTIPO+XDIA+'.TXT'
   ENDIF   
   IF XEMPRESA = '8J'
      XINTERFASE = '\ADSYS\ADCON\J\CON'+XMES+XTIPO+XDIA+'.TXT'
   ENDIF   
   IF XEMPRESA = '6S'
      XINTERFASE = '\ADSYS\ADCON\Q\CON'+XMES+XTIPO+XDIA+'.TXT'
   ENDIF
   IF XEMPRESA = '1L'
      COPY TO C:\PROGRAMA\poltxtaw\CONPOLTAW TYPE SDF 
      XINTERFASE = 'C:\PROGRAMA\poltxtaw\si'+'.TXT'
   ENDIF
   @16,20 SAY XINTERFASE
*   SET TALK ON
*   COPY TO &XINTERFASE TYPE SDF FOR TIPO = 'd'
*   COPY TO &XINTERFASE TYPE SDF 
*   WAIT 'SE GENERO EL ARCHIVO '+XINTERFASE WIND
*   SET TALK OFF
XE = SUBSTR(XEMPRESA,1,1)
a1='\bodega\arch\INTXADCO.dbf'

IF XEMPRESA = "3F"
   xarch = "\bodega\arch\CON"+XMES+"3"+xdia
*   a1='\bodega\arch\con'+XMES+"3"+XDIA+'.dbf'
   a2='\ADSYS\ADCON\F\CON'+XMES+"3"+XDIA+'.dbf'
   copy file &a1 to  &a2
   run \adsys\addbm\addbm -p &xarch
ENDIF
IF XEMPRESA = "4S"
   xarch = "\bodega\arch\CON"+XMES+"4"+xdia
*   a1='\bodega\arch\con'+XMES+"3"+XDIA+'.dbf'
   a2='\ADSYS\ADCON\S\CON'+XMES+"3"+XDIA+'.dbf'
   copy file &a1 to  &a2
   run \adsys\addbm\addbm -p &xarch
ENDIF
IF XEMPRESA = "6S"
   xarch = "\bodega\arch\CON"+XMES+"6"+xdia
*   a1='\bodega\arch\con'+XMES+"3"+XDIA+'.dbf'
   a2='\ADSYS\ADCON\Q\CON'+XMES+"3"+XDIA+'.dbf'
   copy file &a1 to  &a2
   run \adsys\addbm\addbm -p &xarch
ENDIF
IF XEMPRESA = "8J"
   xarch = "\bodega\arch\CON"+XMES+"8"+xdia
*   a1='\bodega\arch\con'+XMES+"3"+XDIA+'.dbf'
   a2='\ADSYS\ADCON\J\CON'+XMES+"3"+XDIA+'.dbf'
   copy file &a1 to  &a2
   run \adsys\addbm\addbm -p &xarch
ENDIF






CLOSE DATABASES
RETURN
