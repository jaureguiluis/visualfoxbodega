*   GENERA LA POLIZA 1 DIARIA DE VENTAS NUEVA EMPRESA
*
STORE FFFFFF TO XFECHA,XFECHAF
@4,1 TO 21,78 CLEAR
@23,1 SAY SPACE(78)
XTITULO = 'POLIZA DE VENTAS'
@6,20  SAY XTITULO
@10,20 SAY 'Fecha de Poliza Inicial : ' GET XFECHA
@12,20 SAY 'Fecha de Poliza Final :   ' GET XFECHAF
@23,20 SAY '      <ESC> Terminar'
READ
IF LASTKEY() = 27 
   RETURN
ENDIF
SET COLOR TO 7*
@20,20 SAY 'FAVOR DE ESPERAR UN MOMENTO ....'
SET COLOR TO &XCOLOR
@ 23,1  SAY SPACE(78)
SET DATE ANSI
XMESPOL = MONTH(XFECHA)
SELECT 1
USE CCCLIENTE INDEX CCCLIENTE
SELECT 3
USE &XPATCB\POLIZA INDEX &XPATCB\POLIZA,&XPATCB\POLCTA
SEEK DTOC(XFECHA)+"D"+STR(1,6,0)
IF .NOT. EOF()
   WAIT 'CUIDADO YA EXISTE UNA POLIZA CON ESTOS DATOS ' WIND
   CLOSE DATABASES
   RETURN
ENDIF   
COPY STRUC TO &XTERMINAL
SELECT 7
USE IPMAESTRO INDEX IPMAESTRO
SELECT 6
USE &XTERMINAL
SELECT 5
USE IPGRUPOS INDEX IPGRUPOS
XARC=SUBSTR(XTERMINAL,1,7)
SELECT 9
USE IPJUNTAR  
COPY STRUC TO &XARC
SELECT 9
USE &XARC
INDEX ON GRUPO+ARTICULO+STR(CLAVE,2) TO &XTERMINAL
APPEND FROM IPENTRADAS FOR FECHAC >= XFECHA .AND. FECHAC <= XFECHAF
APPEND FROM IPSALIDAS  FOR FECHAC >= XFECHA .AND. FECHAC <= XFECHAF
*APPEND FROM CCCREDITOS FOR (FECHAC >= XFECHA .AND. FECHAC <= XFECHAF) .AND. CLAVE = 80
GO TOP
IF EOF()
   SET DATE DMY
   CLOSE DATABASES
   RETURN
ENDIF   
*SET FILTER TO CLAVE = 80
*DO WHILE .NOT. EOF()
*   XARTICULO = ARTICULO
*   SELECT 7
*   SEEK XARTICULO
*   XGRUPO = GRUPO
*   SELECT 9
*   REPLACE GRUPO WITH XGRUPO 
*   SKIP
*ENDDO 
*SET FILTER TO
*GO TOP   
STORE 0 TO XT1VALOR,XT3VALOR,XT7VALOR,XT9VALOR,XT79VALOR,XT51VALOR,XT51CVALOR,XT51DVALOR,XT52VALOR,XT52CVALOR,XT53VALOR,XT53CVALOR,XT54VALOR,XT58VALOR,XT59VALOR,XT60VALOR,XT10VALOR,XT14VALOR
SELECT 5
DO WHILE .NOT. EOF()
   XGRUPO   = NUMERO
   XNOMBRE  = NOMBRE
   XSCUENTA = VAL(GRUPOA)
   SELECT 9
   SEEK XGRUPO
   DO WHILE GRUPO = XGRUPO .AND. .NOT. EOF()
      XARTICULO = ARTICULO
      XPROPIO   = SUBSTR(ARTICULO,1,1)
      IF XPROPIO = 'P'
         XCUENTA = 1130
      ELSE
         XCUENTA = 1135
      ENDIF   
      STORE 0 TO X1VALOR,X3VALOR,X7VALOR,X9VALOR,X79VALOR,X51VALOR,X51CVALOR,X51DVALOR,X52VALOR,X52CVALOR,X53VALOR,X53CVALOR,X54VALOR,X58VALOR,X59VALOR,X60VALOR,X10VALOR,X14VALOR
      DO WHILE GRUPO = XGRUPO .AND. SUBSTR(ARTICULO,1,1) = XPROPIO .AND. .NOT. EOF()
         XCLIENTE = CLIENTE
         SELECT 1
         SEEK XCLIENTE
         XMN = CLAVE
         SELECT 9

         IF XMN = 'XX'
            X51DVALOR    = X51DVALOR    + VALOR
         ELSE
           IF XPROPIO = 'C'
              IF CLAVE = 51 
                 X51CVALOR    = X51CVALOR    + VALOR
              ENDIF
              IF CLAVE = 52 
                 X52CVALOR    = X52CVALOR    + VALOR
              ENDIF
              IF CLAVE = 53 
                 X53CVALOR    = X53CVALOR    + VALOR
              ENDIF
           ELSE      
              IF CLAVE = 51 
                 X51VALOR    = X51VALOR    + VALOR
              ENDIF
              IF CLAVE = 52 
                 X52VALOR    = X52VALOR    + VALOR
              ENDIF
              IF CLAVE = 53 
                 X53VALOR    = X53VALOR    + VALOR
              ENDIF
           ENDIF   
         ENDIF   

         IF CLAVE = 54 
            X54VALOR    = X54VALOR    + VALOR
         ENDIF
         IF CLAVE = 1 
            X1VALOR    = X1VALOR    + VALOR - precio * merma
         ENDIF
         IF CLAVE = 79 
            X79VALOR    = X79VALOR    + VALOR
         ENDIF
         IF CLAVE = 3 
            X3VALOR    = X3VALOR    + VALOR
         ENDIF
         IF CLAVE = 7 
            X7VALOR    = X7VALOR    + VALOR
         ENDIF
         IF CLAVE = 58 
            X58VALOR    = X58VALOR    + VALOR
         ENDIF
         IF CLAVE = 59 
            X59VALOR    = X59VALOR    + VALOR
         ENDIF
         IF CLAVE = 60 
            X60VALOR    = X60VALOR    + VALOR
         ENDIF

         IF CLAVE = 9 .OR. CLAVE = 8 
*           BONIFICACION INDIVIDUAL
            X9VALOR  = X9VALOR    + VALOR
            XVALOR   = VALOR
            XCLIENTE = CLIENTE
            XFOLIO   = FOLIO
            SELECT 1
            SEEK XCLIENTE
            XCLIENTE = SUBSTR(NOMBRE,1,21)
            SELECT 6
            APPEND BLANK
            REPLACE FECHA WITH XFECHA,POLIZA WITH 1
            REPLACE CUENTA WITH 4110,SCUENTA WITH 1,SSCUENTA WITH 0,SSSCUENTA WITH 0
            REPLACE VALOR WITH XVALOR,MOVIMIENTO WITH '+'
            REPLACE TIPO WITH 'D',PERIODO WITH XMESPOL
            REPLACE CONCEPTO WITH XCLIENTE+' F/'+STR(XFOLIO,6)
            IF XPROPIO = 'C'
               REPLACE SCUENTA WITH 2
            ENDIF
            SELECT 9
         ENDIF
         IF CLAVE = 59 
*           CANCELACION BONIFICACION INDIVIDUAL
            X59VALOR    = X59VALOR    + VALOR
            XVALOR = VALOR
            XCLIENTE = CLIENTE
            XFOLIO = FOLIO
            SELECT 1
            SEEK XCLIENTE
            XCLIENTE = SUBSTR(NOMBRE,1,21)
            SELECT 6
            APPEND BLANK
            REPLACE FECHA WITH XFECHA,POLIZA WITH 1
            REPLACE CUENTA WITH 4110,SCUENTA WITH 1,SSCUENTA WITH 0,SSSCUENTA WITH 0
            REPLACE VALOR WITH XVALOR,MOVIMIENTO WITH '-'
            REPLACE TIPO WITH 'D',PERIODO WITH XMESPOL
            REPLACE CONCEPTO WITH XCLIENTE+' F/'+STR(XFOLIO,6)+' CANCELACION'
            IF XPROPIO = 'C'
               REPLACE SCUENTA WITH 2
            ENDIF
            SELECT 9
         ENDIF
         IF CLAVE = 10
*           BONIFICACION PUBLICIDAD
            X10VALOR    = X10VALOR    + VALOR
            XVALOR = VALOR
            XCLIENTE = CLIENTE
            XFOLIO = FOLIO
            SELECT 1
            SEEK XCLIENTE
            XCLIENTE = SUBSTR(NOMBRE,1,21)
            SELECT 6
            APPEND BLANK
            REPLACE FECHA WITH XFECHA,POLIZA WITH 1
            REPLACE CUENTA WITH 5200,SCUENTA WITH 13,SSCUENTA WITH 2,SSSCUENTA WITH 0
            REPLACE VALOR WITH XVALOR,MOVIMIENTO WITH '+'
            REPLACE TIPO WITH 'D',PERIODO WITH XMESPOL
            REPLACE CONCEPTO WITH XCLIENTE+' F/'+STR(XFOLIO,6)
            SELECT 9
         ENDIF
         IF CLAVE = 14
*           DIF EN PRECIO
            X14VALOR    = X14VALOR    + VALOR
            XVALOR = VALOR
            XFOLIO = FOLIO
            SELECT 6
            APPEND BLANK
            REPLACE FECHA WITH XFECHA,POLIZA WITH 1
            REPLACE CUENTA WITH XCUENTA,SCUENTA WITH XSCUENTA,SSCUENTA WITH 1,SSSCUENTA WITH 0
            REPLACE VALOR WITH X14VALOR,MOVIMIENTO WITH '+'
            REPLACE TIPO WITH 'D',REFERENCIA WITH 'CPRA',PERIODO WITH XMESPOL
            REPLACE CONCEPTO WITH 'DIF EN PRECIO F/'+STR(XFOLIO,6)
            IF X14VALOR > 0
               REPLACE VALOR WITH X14VALOR,MOVIMIENTO WITH '+'
            ELSE
               REPLACE VALOR WITH X14VALOR*-1,MOVIMIENTO WITH '-'
            ENDIF 
            SELECT 9
         ENDIF

         SKIP
      ENDDO
      XT1VALOR    = XT1VALOR    + X1VALOR
      XT3VALOR    = XT3VALOR    + X3VALOR
      XT7VALOR    = XT7VALOR    + X7VALOR
      XT9VALOR    = XT9VALOR    + X9VALOR
      XT51VALOR   = XT51VALOR   + X51VALOR
      XT51DVALOR  = XT51DVALOR  + X51DVALOR
      XT51CVALOR  = XT51CVALOR  + X51CVALOR
      XT52CVALOR  = XT52CVALOR  + X52CVALOR
      XT52VALOR   = XT52VALOR   + X52VALOR
      XT53CVALOR  = XT53CVALOR  + X53CVALOR
      XT53VALOR   = XT53VALOR   + X53VALOR
      XT54VALOR   = XT54VALOR   + X54VALOR
      XT79VALOR   = XT79VALOR   + X79VALOR
      XT10VALOR   = XT10VALOR   + X10VALOR
      XT14VALOR   = XT14VALOR   + X14VALOR



      IF X1VALOR <>0
         SELECT 6
         APPEND BLANK
         REPLACE FECHA WITH XFECHA,POLIZA WITH 1
         REPLACE CUENTA WITH XCUENTA,SCUENTA WITH XSCUENTA,SSCUENTA WITH 1,SSSCUENTA WITH 0
         REPLACE VALOR WITH X1VALOR,MOVIMIENTO WITH '+',CONCEPTO WITH "COMPRAS "
         REPLACE TIPO WITH 'D',REFERENCIA WITH 'CPRA',PERIODO WITH XMESPOL
      ENDIF

      IF X54VALOR <>0
      
*        DEVOLUCION X PROVEEDOR
  
         SELECT 6
         APPEND BLANK
         REPLACE FECHA WITH XFECHA,POLIZA WITH 1
         REPLACE CUENTA WITH XCUENTA,SCUENTA WITH XSCUENTA,SSCUENTA WITH 1,SSSCUENTA WITH 0
         REPLACE VALOR WITH X54VALOR,MOVIMIENTO WITH '-',CONCEPTO WITH "DEVOLUCION COMPRA"
         REPLACE TIPO WITH 'D',REFERENCIA WITH 'DEVCPRA',PERIODO WITH XMESPOL
      ENDIF


      SELECT 9
   ENDDO
   SELECT 5
   SKIP
ENDDO
SELECT 6
APPEND BLANK
REPLACE FECHA WITH XFECHA,POLIZA WITH 1
REPLACE CUENTA WITH 2300,SCUENTA WITH 1,SSCUENTA WITH 0,SSSCUENTA WITH 0
REPLACE VALOR WITH XT1VALOR-XT54VALOR+XT14VALOR,MOVIMIENTO WITH '-',CONCEPTO WITH "COMPRAS"
REPLACE TIPO WITH 'D',REFERENCIA WITH 'CPRA',PERIODO WITH XMESPOL

*  CREDITO    

IF XT51VALOR <>0
   SELECT 6
   APPEND BLANK
   REPLACE FECHA WITH XFECHA,POLIZA WITH 1
   REPLACE CUENTA WITH 4101,SCUENTA WITH 2,SSCUENTA WITH 0,SSSCUENTA WITH 0
   REPLACE CONCEPTO WITH 'VENTA CREDITO',VALOR WITH XT51VALOR,MOVIMIENTO WITH '-'
   REPLACE TIPO WITH 'D',PERIODO WITH XMESPOL,REFERENCIA WITH 'CRED'
   APPEND BLANK
   REPLACE FECHA WITH XFECHA,POLIZA WITH 1
   REPLACE CUENTA WITH 1110,SCUENTA WITH 2,SSCUENTA WITH 0,SSSCUENTA WITH 0
   REPLACE CONCEPTO WITH 'VENTA CREDITO',VALOR WITH XT51VALOR,MOVIMIENTO WITH '+'
   REPLACE TIPO WITH 'D',PERIODO WITH XMESPOL,REFERENCIA WITH 'CRED'
ENDIF

*  CONTADO    

IF XT52VALOR <>0
   SELECT 6
   APPEND BLANK
   REPLACE FECHA WITH XFECHA,POLIZA WITH 1
   REPLACE CUENTA WITH 4101,SCUENTA WITH 1,SSCUENTA WITH 0,SSSCUENTA WITH 0
   REPLACE CONCEPTO WITH 'VENTA CONTADO',VALOR WITH XT52VALOR,MOVIMIENTO WITH '-'
   REPLACE TIPO WITH 'D',PERIODO WITH XMESPOL,REFERENCIA WITH 'CTO'
   APPEND BLANK
   REPLACE FECHA WITH XFECHA,POLIZA WITH 1
   REPLACE CUENTA WITH 1110,SCUENTA WITH 1,SSCUENTA WITH 0,SSSCUENTA WITH 0
   REPLACE CONCEPTO WITH 'VENTA CONTADO',VALOR WITH XT52VALOR,MOVIMIENTO WITH '+'
   REPLACE TIPO WITH 'D',PERIODO WITH XMESPOL,REFERENCIA WITH 'CTO'
ENDIF

*  TICKETS    

IF XT53VALOR <>0
   SELECT 6
   APPEND BLANK
   REPLACE FECHA WITH XFECHA,POLIZA WITH 1
   REPLACE CUENTA WITH 4101,SCUENTA WITH 1,SSCUENTA WITH 0,SSSCUENTA WITH 0
   REPLACE CONCEPTO WITH 'VENTA CONTADO G',VALOR WITH XT53VALOR,MOVIMIENTO WITH '-'
   REPLACE TIPO WITH 'D',PERIODO WITH XMESPOL,REFERENCIA WITH 'TICK'
   APPEND BLANK
   REPLACE FECHA WITH XFECHA,POLIZA WITH 1
   REPLACE CUENTA WITH 1110,SCUENTA WITH 1,SSCUENTA WITH 0,SSSCUENTA WITH 0
   REPLACE CONCEPTO WITH 'VENTA CONTADO G',VALOR WITH XT53VALOR,MOVIMIENTO WITH '+'
   REPLACE TIPO WITH 'D',PERIODO WITH XMESPOL,REFERENCIA WITH 'TICK'
ENDIF


*  EXPORTACION    

IF XT51DVALOR <>0
   SELECT 6
   APPEND BLANK
   REPLACE FECHA WITH XFECHA,POLIZA WITH 1
   REPLACE CUENTA WITH 4101,SCUENTA WITH 3,SSCUENTA WITH 0,SSSCUENTA WITH 0
   REPLACE CONCEPTO WITH 'VENTA EXPORTACION',VALOR WITH XT51DVALOR,MOVIMIENTO WITH '-'
   REPLACE TIPO WITH 'D',PERIODO WITH XMESPOL,REFERENCIA WITH 'EXP'
   APPEND BLANK
   REPLACE FECHA WITH XFECHA,POLIZA WITH 1
   REPLACE CUENTA WITH 1110,SCUENTA WITH 2,SSCUENTA WITH 0,SSSCUENTA WITH 0
   REPLACE CONCEPTO WITH 'VENTA EXPORTACION',VALOR WITH XT51DVALOR,MOVIMIENTO WITH '+'
   REPLACE TIPO WITH 'D',PERIODO WITH XMESPOL,REFERENCIA WITH 'EXP'
ENDIF

*  PISO    

IF XT51CVALOR <>0
   SELECT 6
   APPEND BLANK
   REPLACE FECHA WITH XFECHA,POLIZA WITH 1
   REPLACE CUENTA WITH 4101,SCUENTA WITH 4,SSCUENTA WITH 0,SSSCUENTA WITH 0
   REPLACE CONCEPTO WITH 'VENTA CREDITO',VALOR WITH XT51CVALOR,MOVIMIENTO WITH '-'
   REPLACE TIPO WITH 'D',PERIODO WITH XMESPOL
   APPEND BLANK
   REPLACE FECHA WITH XFECHA,POLIZA WITH 1
   REPLACE CUENTA WITH 1110,SCUENTA WITH 2,SSCUENTA WITH 0,SSSCUENTA WITH 0
   REPLACE CONCEPTO WITH 'VENTA CREDITO',VALOR WITH XT51CVALOR,MOVIMIENTO WITH '+'
   REPLACE TIPO WITH 'D',PERIODO WITH XMESPOL
ENDIF

*  PISO    

IF XT52CVALOR <>0
   SELECT 6
   APPEND BLANK
   REPLACE FECHA WITH XFECHA,POLIZA WITH 1
   REPLACE CUENTA WITH 4101,SCUENTA WITH 4,SSCUENTA WITH 0,SSSCUENTA WITH 0
   REPLACE CONCEPTO WITH 'VENTA CONTADO',VALOR WITH XT52CVALOR,MOVIMIENTO WITH '-'
   REPLACE TIPO WITH 'D',PERIODO WITH XMESPOL
   APPEND BLANK
   REPLACE FECHA WITH XFECHA,POLIZA WITH 1
   REPLACE CUENTA WITH 1110,SCUENTA WITH 1,SSCUENTA WITH 0,SSSCUENTA WITH 0
   REPLACE CONCEPTO WITH 'VENTA CONTADO',VALOR WITH XT52CVALOR,MOVIMIENTO WITH '+'
   REPLACE TIPO WITH 'D',PERIODO WITH XMESPOL
ENDIF

IF XT53CVALOR <>0
   SELECT 6
   APPEND BLANK
   REPLACE FECHA WITH XFECHA,POLIZA WITH 1
   REPLACE CUENTA WITH 4101,SCUENTA WITH 4,SSCUENTA WITH 0,SSSCUENTA WITH 0
   REPLACE CONCEPTO WITH 'VENTA CONTADO G',VALOR WITH XT53CVALOR,MOVIMIENTO WITH '-'
   REPLACE TIPO WITH 'D',PERIODO WITH XMESPOL
   APPEND BLANK
   REPLACE FECHA WITH XFECHA,POLIZA WITH 1
   REPLACE CUENTA WITH 1110,SCUENTA WITH 1,SSCUENTA WITH 0,SSSCUENTA WITH 0
   REPLACE CONCEPTO WITH 'VENTA CONTADO G',VALOR WITH XT53CVALOR,MOVIMIENTO WITH '+'
   REPLACE TIPO WITH 'D',PERIODO WITH XMESPOL
ENDIF


* DEVOLUCION

IF XT3VALOR <>0
   SELECT 6
   APPEND BLANK
   REPLACE FECHA WITH XFECHA,POLIZA WITH 1
   REPLACE CUENTA WITH 4120,SCUENTA WITH 1,SSCUENTA WITH 0,SSSCUENTA WITH 0
   REPLACE CONCEPTO WITH 'DEVOLUCION',VALOR WITH XT3VALOR,MOVIMIENTO WITH '+'
   REPLACE TIPO WITH 'D',PERIODO WITH XMESPOL,REFERENCIA WITH 'DEV'
ENDIF

* CANCELACION DEVOLUCION

IF XT58VALOR <>0
   SELECT 6
   APPEND BLANK
   REPLACE FECHA WITH XFECHA,POLIZA WITH 1
   REPLACE CUENTA WITH 4120,SCUENTA WITH 1,SSCUENTA WITH 0,SSSCUENTA WITH 0
   REPLACE CONCEPTO WITH 'CANCELA DEVOLUCION',VALOR WITH XT58VALOR,MOVIMIENTO WITH '-'
   REPLACE TIPO WITH 'D',PERIODO WITH XMESPOL,REFERENCIA WITH 'CANDEV'
ENDIF

* CANCELACION

IF XT7VALOR <>0
     SELECT 6
     APPEND BLANK
     REPLACE FECHA WITH XFECHA,POLIZA WITH 1
     REPLACE CUENTA WITH 4101,SCUENTA WITH 2,SSCUENTA WITH 0,SSSCUENTA WITH 0
     REPLACE CONCEPTO WITH 'CANCELACION',VALOR WITH XT7VALOR,MOVIMIENTO WITH '+'
     REPLACE TIPO WITH 'D',PERIODO WITH XMESPOL,REFERENCIA WITH 'CAN'
ENDIF

* CANCELACION CANCELACION

IF XT60VALOR <>0
     SELECT 6
     APPEND BLANK
     REPLACE FECHA WITH XFECHA,POLIZA WITH 1
     REPLACE CUENTA WITH 4101,SCUENTA WITH 2,SSCUENTA WITH 0,SSSCUENTA WITH 0
     REPLACE CONCEPTO WITH 'CANCELA CANCELACION',VALOR WITH XT60VALOR,MOVIMIENTO WITH '-'
     REPLACE TIPO WITH 'D',PERIODO WITH XMESPOL,REFERENCIA WITH 'CAN'
ENDIF
  
* BONIFICACION + CANCELACION + DEVOLUCION

IF XT10VALOR+XT9VALOR+XT3VALOR+XT7VALOR <>0
   SELECT 6
   APPEND BLANK
   REPLACE FECHA WITH XFECHA,POLIZA WITH 1
   REPLACE CUENTA WITH 1110,SCUENTA WITH 2,SSCUENTA WITH 0,SSSCUENTA WITH 0
   REPLACE CONCEPTO WITH 'DEV-CAN-BONI',VALOR WITH XT9VALOR+XT3VALOR+XT7VALOR+XT10VALOR,MOVIMIENTO WITH '-'
   REPLACE TIPO WITH 'D',PERIODO WITH XMESPOL,REFERENCIA WITH 'DEV'
*   IF SUBSTR(PAT,2,2) = "89"
*      REPLACE SCUENTA WITH 50
*   ENDIF   
ENDIF

* CANCELACION DE BONIFICACION + CANCELACION + DEVOLUCION

IF XT58VALOR+XT59VALOR+XT60VALOR <>0
   SELECT 6
   APPEND BLANK
   REPLACE FECHA WITH XFECHA,POLIZA WITH 1
   REPLACE CUENTA WITH 1110,SCUENTA WITH 2,SSCUENTA WITH 0,SSSCUENTA WITH 0
   REPLACE CONCEPTO WITH 'CANCELACION DEV-CAN-BONI',VALOR WITH XT58VALOR+XT59VALOR+XT60VALOR,MOVIMIENTO WITH '+'
   REPLACE TIPO WITH 'D',PERIODO WITH XMESPOL,REFERENCIA WITH 'DEV'
*   IF SUBSTR(PAT,2,2) = "89"
*      REPLACE SCUENTA WITH 50
*   ENDIF   
ENDIF


*  IVA

XARC=SUBSTR(XTERMINAL,1,5)
SELECT 4
USE CCJUNTAR
COPY STRUC TO &XARC
SELECT 4
USE &XARC
APPEND FROM cccargos FOR FECHAC >= XFECHA .AND. FECHAC <= XFECHAF
sum all iva to xtiva 

IF XTiva <>0
   SELECT 6
   APPEND BLANK
   REPLACE FECHA WITH XFECHA,POLIZA WITH 1
   REPLACE CUENTA WITH 1110,SCUENTA WITH 2,SSCUENTA WITH 0,SSSCUENTA WITH 0
   REPLACE CONCEPTO WITH 'CREDITO IVA  ',VALOR WITH XTIVA,MOVIMIENTO WITH '+'
   REPLACE TIPO WITH 'D',PERIODO WITH XMESPOL
   APPEND BLANK
   REPLACE FECHA WITH XFECHA,POLIZA WITH 1
   REPLACE CUENTA WITH 2150,SCUENTA WITH 1,SSCUENTA WITH 0,SSSCUENTA WITH 0
   REPLACE CONCEPTO WITH 'IVA POR PAGAR',VALOR WITH XTIVA,MOVIMIENTO WITH '-'
   REPLACE TIPO WITH 'D',PERIODO WITH XMESPOL
ENDIF


XARC=SUBSTR(XTERMINAL,1,6)
SELECT 6
SORT ON MOVIMIENTO,CUENTA,SCUENTA,SSCUENTA TO &XARC
CLOSE DATABASES
SELECT 3
USE &XPATCB\POLIZA INDEX &XPATCB\POLIZA,&XPATCB\POLCTA
APPEND FROM &XARC
SET DATE DMY
CLOSE DATABASES

@14,20 SAY 'SE GENERO LA SIGUIENTE POLIZA:'
@16,20 SAY 'Numero 1 DIARIO DEL : ' GET XFECHA
@20,20 SAY '                                '
CLEAR GETS
WAIT ''
RETURN
