*    OBTIENE LOS RFC EQUIVOCADOS
*
SELECT 1
USE &XPATCB\CUENTA INDEX &XPATCB\CUENTA ALIAS CUENTA
@ 4, 1 TO 21,78 CLEAR
@23, 1 SAY SPACE(77)
XTITULO = 'RFC INCORRECTOS'
SINO = 'SI'
XDEST = 'T'
STORE DATE() TO XFECHAI,XFECHAF
XFECHAI=XFECHAI-DAY(XFECHAI)+1
STORE 0 TO XCUENTA,XSCUENTA,XSSCUENTA,XSSSCUENTA
XCUENTA = 1150
SEEK STR(XCUENTA,4)+STR(XSCUENTA,4)+STR(XSSCUENTA,3)+STR(XSSSCUENTA,3) 
@12,20 SAY NOMBRE
@06,20 SAY XTITULO
@14,20 SAY 'Teclee Fecha Inicial a Imprimir : ' GET XFECHAI
@16,20 SAY 'Teclee Fecha Final a Imprimir :   ' GET XFECHAF
@18,20 SAY 'Informacion en <I>mpresora O <T>erminal ' GET XDEST PICT '@M I,T'
@23,25 SAY '<ESC> Terminar'
READ
IF LASTKEY() = 27
   CLOSE DATABASES
   RETURN
ENDIF
@23, 1 SAY SPACE(77)
SET COLOR TO 7*
@23,20 SAY 'FAVOR DE ESPERAR UN MOMENTO ....'
SET COLOR TO &XCOLOR
XTITULO = XTITULO +' DEL : '+DTOC(XFECHAI)+' AL : '+DTOC(XFECHAF)
SELECT 4
USE \COMUNES\RFC INDEX \COMUNES\RFC
SELECT 3
USE &XPATCB\POLIZA INDEX &XPATCB\POLCTA
SET RELATION TO STR(CUENTA,4)+STR(SCUENTA,4)+STR(SSCUENTA,3)+STR(SSSCUENTA,3) INTO CUENTA
*SET FILTER TO FECHA >= XFECHAI .AND. FECHA <=XFECHAF .AND. CUENTA >=XCUENTAI .AND. CUENTA <=XCUENTAF
*SEEK STR(XCUENTA,4)+STR(XSCUENTA,4)+STR(XSSCUENTA,3)+STR(XSSSCUENTA,3) 
SEEK STR(XCUENTA,4)
IF EOF()
   CLOSE DATABASES
   RETURN
ENDIF
NPAG = 0
N   = NLPP
XNLPP = NLPP
SET DEVICE TO PRINT
IF XDEST = 'T'
   XT=XTERMINAL+'.TXT'
   SET PRINTER TO &XT
ELSE
   ??? CHR(15)
ENDIF
XMESPOL = MONTH(XFECHAI)
STORE 0 TO XCARGOS,XABONOS,XSALDO
DO WHILE STR(XCUENTA,4)= STR(CUENTA,4)  .AND. .NOT. EOF()
   IF N>=XNLPP
      NPAG = NPAG + 1
      @0,4   SAY FFFFFF PICT '@E'
      @0,15  SAY TIME()
      @0,118 SAY 'PAG :'
      @0,124 SAY NPAG PICT '999'
      IF XDEST ='I'
         ??? CHR(18)+CHR(14)
         @1,(44-LEN(XCIA))/2 SAY XCIA
         ??? CHR(15)+CHR(14)
         @2,(70-LEN(XTITULO))/2 SAY XTITULO
      ELSE
         @1,20 SAY XCIA
         @2,20 SAY XTITULO
         XNLPP = 10000
      ENDIF
      @4, 1  SAY 'ASI.'
      @4,10  SAY 'CUENTA'
      @4,24  SAY 'N O M B R E'
      @4,52  SAY 'C O N C E P T O'
      @4,81  SAY 'R.F.C.'
      @4,97  SAY 'FECHA'
      @4,103 SAY 'POLIZA'
      @4,110 SAY 'REF.'
      @4,121 SAY 'CARGO/ABONO'
      @5, 1 SAY REPLICATE('=',136)
      N=5
   ENDIF
   IF FECHA >= XFECHAI .AND. FECHA <=XFECHAF
      XRFC= ARTICULO
      XN = CONCEPTO
      SELECT 4
      SEEK XRFC
      IF EOF()
*         APPEND BLANK
*         REPLACE RFC WITH XRFC,NOMBRE WITH XN
         SELECT 3
         N=N+1
         @N,0 SAY RECNO() PICT '999999'
         @N,7 SAY STR(CUENTA,4)+STR(SCUENTA,2)+STR(SSCUENTA,2)+STR(SSSCUENTA,2) 
         @N,18 SAY CUENTA->NOMBRE PICT 'XXXXXXXXXXXXXXXXX'
         @N,36 SAY CONCEPTO 
         @N,77 SAY ARTICULO
         @N,93 SAY FECHA 
         @N,104 SAY POLIZA PICT '9999'
         @N,109 SAY TIPO
         @N,111 SAY REFERENCIA PICT 'XXXXXXXXXX'
         IF MOVIMIENTO = '+'
            XCARGOS = XCARGOS + VALOR
            @N,122 SAY VALOR PICT '999,999,999.99'
            @N,136 SAY MOVIMIENTO
         ELSE
            XABONOS = XABONOS + VALOR
            @N,122 SAY VALOR PICT '999,999,999.99'
            @N,136 SAY MOVIMIENTO
         ENDIF
      ENDIF  
      SELECT 3     
   ENDIF    
   SKIP
ENDDO
EJECT
SET DEVICE TO SCREEN
CLOSE DATABASES
IF XDEST = 'T'
   DO TERMINAL
ENDIF
RETURN
