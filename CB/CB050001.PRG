*    este programa obtiene los indices de todos los archivos para
*    el caso de que hayan danado
*
@04,01 TO 21,78 CLEAR
@23,01 SAY SPACE(77)
SINO = 'NO'
@ 4,5 SAY 'ESTE PROCESO GENERA LOS ARCHIVOS DE INDICES DEL SISTEMA'
@ 6,5 SAY 'TAMBIEN BORRA FISICAMENTE LOS REGISTROS MARCADOS COMO BORRADOS'
@ 8,5 SAY 'SE RECOMIENDA EJECUTARLO CUANDO SE HA TENIDO MUCHAS BAJAS DE REGISTROS'
@10,5 SAY 'O CUANDO SE HAYA SUSPENDIDO BRUSCAMENTE EL PROCESO NORMAL DEL SISTEMA'
@12,5 SAY 'COMO CORTE DE ENERGIA ELECTRICA O FALLAS DE LA MICROCOMPUTADORA'
@14,5 SAY 'TAMBIEN SE RECOMIENDA EJECUTARLO CUANDO SE PRESENTAN FALLAS ANORMALES'
@16,5 SAY 'COMO NO ENCONTRAR DATOS QUE ESTAMOS SEGUROS DE QUE EXISTEN'
@18,5 SAY 'Y FINALMENTE SE RECOMIENDA EJECUTARLO COMO MANTENIMIENTO UN VEZ AL MES'
@20,20 SAY 'ESTE PROCESO PUEDE TARDAR ALGUNOS MINUTOS.....'
@23,20 SAY 'ESTA SEGURO QUE DESEA CONTINUAR ' GET SINO PICT '@M SI,NO'
READ
IF SINO <> 'SI'
   RETURN
ENDIF
SET DATE ANSI
@04,01 TO 21,78 CLEAR
@23,01 SAY SPACE(77)
STORE 'S' TO XCU,XSA,XPO,XEM
@8,20 SAY 'TECLEE  (S) A LOS ARCHIVOS QUE DESEA DAR REORGANIZACION'
@10,20 SAY 'AL ARCHIVO DE CUENTAS :  ' GET XCU PICT '@M S,N'
@12,20 SAY 'AL ARCHIVO DE SALDOS :   ' GET XSA PICT '@M S,N'
@14,20 SAY 'AL ARCHIVO DE POLIZAS :  ' GET XPO PICT '@M S,N'
SINO = 'NO'
@23,20 SAY 'ESTA SEGURO QUE DESEA CONTINUAR ' GET SINO PICT '@M SI,NO'
READ
IF SINO <> 'SI'
   RETURN
ENDIF
@04,01 TO 21,78 CLEAR
@23,01 SAY SPACE(77)
@18,20 SAY "FAVOR DE ESPERAR UN MOMENTO"
@20,10 SAY "PROCESANDO EL ARCHIVO ="
*
@9,5 TO 11,73 DOUBLE
IF XCU = 'S'
   @20,35 SAY "CATALOGO"
   @10,6 SAY CHR(176)+CHR(176)+CHR(176)
   USE &XPATCB\CUENTA
   @10,9 SAY CHR(176)+CHR(176)+CHR(176)
   PACK
   @10,12 SAY CHR(176)+CHR(176)+CHR(176)
   ERASE  &XPATCB\CUENTA.IDX
   @10,15 SAY CHR(176)+CHR(176)+CHR(176)
   @20,35 SAY "CATALOGO"
   @10,18 SAY CHR(176)+CHR(176)+CHR(176)
   INDEX ON STR(CUENTA,4)+STR(SCUENTA,4)+STR(SSCUENTA,3)+STR(SSSCUENTA,3) TO  &XPATCB\CUENTA
   @10,21 SAY CHR(176)+CHR(176)+CHR(176)
ENDIF
@10,24 SAY CHR(176)+CHR(176)+CHR(176)
*
IF XSA = 'S'
   @20,35 SAY "SALDOS   "
   @10,27 SAY CHR(176)+CHR(176)+CHR(176)
   USE &XPATCB\SALDOS
   @10,30 SAY CHR(176)+CHR(176)+CHR(176)
   PACK
   @10,33 SAY CHR(176)+CHR(176)+CHR(176)
   ERASE  &XPATCB\SALDOS.IDX
   @10,36 SAY CHR(176)+CHR(176)+CHR(176)
   @20,35 SAY "SALDOS   "
   @10,39 SAY CHR(176)+CHR(176)+CHR(176)
   INDEX ON  STR(CUENTA,4)+STR(SCUENTA,4)+STR(SSCUENTA,3)+STR(SSSCUENTA,3)+STR(PERIODO,2)+STR(ANO,4)  TO &XPATCB\SALDOS
   @10,42 SAY CHR(176)+CHR(176)+CHR(176)
ENDIF
@10,45 SAY CHR(176)+CHR(176)+CHR(176)
*
IF XPO = 'S'
   @20,35 SAY "POLIZAS   "
   @10,48 SAY CHR(176)+CHR(176)+CHR(176)
   USE &XPATCB\POLIZA
   @10,51 SAY CHR(176)+CHR(176)+CHR(176)
   PACK
   @10,54 SAY CHR(176)+CHR(176)+CHR(176)
   ERASE  &XPATCB\POLIZA.IDX
   @10,57 SAY CHR(176)+CHR(176)+CHR(176)
   ERASE  &XPATCB\POLCTA.IDX
   @10,60 SAY CHR(176)+CHR(176)+CHR(176)
   @20,35 SAY "POLIZAS   "
   @10,63 SAY CHR(176)+CHR(176)+CHR(176)
   INDEX ON DTOC(FECHA)+TIPO+STR(POLIZA,6,0) TO &XPATCB\POLIZA
   @10,66 SAY CHR(176)+CHR(176)+CHR(176)
   INDEX ON STR(CUENTA,4)+STR(SCUENTA,4)+STR(SSCUENTA,3)+STR(SSSCUENTA,3)+DTOC(FECHA)+TIPO+STR(POLIZA,4,0) TO &XPATCB\POLCTA
   @10,69 SAY CHR(176)+CHR(176)+CHR(176)
ENDIF
*
USE CIAS
PACK
CLOSE DATABASES
SET DATE DMY
@10,72 SAY CHR(176)
RETURN
