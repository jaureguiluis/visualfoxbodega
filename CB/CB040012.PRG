*    LISTA RFC
*
@ 4,1 TO 21,78 CLEAR
@23,1 SAY SPACE(78)
SINO    = 'S'
XDEST   = 'T'
XTITULO = 'RELACION DE R.F.C.'
@10,20 SAY XTITULO
@18,20 SAY 'Informacion en <I>mpresora o <T>erminal ' GET XDEST PICT '@M I,T'
@23,25 SAY '<ESC> Terminar'
READ
IF LASTKEY() = 27
   RETURN
ENDIF
@23,1 SAY SPACE(78)
SET COLOR TO 7*
@23,20 SAY 'FAVOR DE ESPERAR UN MOMENTO .....'
SET COLOR TO &XCOLOR
SELECT 7
USE \COMUNES\RFC INDEX \COMUNES\RFC
NPAG = 0
N =NLPP
SET DEVICE TO PRINT
IF XDEST = 'T'
   XT=XTERMINAL+'.TXT'
   SET PRINTER TO &XT
ENDIF
??? CHR(18)
DO WHILE .NOT. EOF()
  IF N>=NLPP
     NPAG = NPAG + 1
     @0,1  SAY FFFFFF
     @0,68 SAY 'PAGINA:'
     @0,76 SAY NPAG PICT '9999'
     ??? CHR(18)+CHR(14)
     @1,(44-LEN(XCIA))/2 SAY XCIA
     ??? CHR(15)+CHR(14)
     @2,(70-LEN(XCIA))/2 SAY XTITULO
     ??? CHR(18)
     @4, 5 SAY 'R.F.C.'
     @4,15 SAY ' N  O  M  B  R  E'
     @5, 1 SAY REPLICATE('=',79)
     N=5
  ENDIF
  N=N+1
  @N, 1 SAY RFC
  @N,20 SAY NOMBRE
  SKIP
ENDDO
EJECT
SET DEVICE TO SCREEN
CLOSE DATABASES
IF XDEST = 'T'
   DO TERMINAL
ENDIF
RETURN
