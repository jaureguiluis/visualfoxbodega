* ALTAS BAJAS Y CAMBIOS DE CUENTAS
*
SELECT 1
USE &XPATCB\CUENTA INDEX &XPATCB\CUENTA
STORE 0 TO XCUENTA,XSCUENTA,XSSCUENTA,XSSSCUENTA
DO WHILE .T.
   @ 4,1  TO 21,78 CLEAR
   @ 23,1 SAY SPACE(78)
   @ 5,25 SAY 'ALTAS,BAJAS Y CAMBIOS A CUENTAS'
   SINO = 'SI'
   @11,60 SAY '1 = ACTIVO'
   @12,60 SAY '2 = PASIVO'
   @13,60 SAY '3 = CAPITAL'
   @14,60 SAY '4 = INGRESOS'
   @15,60 SAY '5 = COSTOS'
   @16,60 SAY '6 = GASTOS'
   @ 10,15 SAY 'Numero de Cuenta :     ' GET XCUENTA    PICT '9999'
   @ 11,15 SAY 'Numero de S-Cuenta :   ' GET XSCUENTA   PICT '9999'
   @ 12,15 SAY 'Numero de SS-Cuenta :  ' GET XSSCUENTA  PICT '999'
   @ 13,15 SAY 'Numero de SSS-Cuenta : ' GET XSSSCUENTA PICT '999'
   @ 23,20 SAY '<F1> Lista                 <ESC> Terminar'
   READ
   IF LASTKEY() = 27
      EXIT
   ENDIF
   DO WHILE LASTKEY() = 4 .OR. LASTKEY() = 28 .OR. LASTKEY() = 29 .OR. LASTKEY() = -7
      @ 23,2 SAY  '<F2> Agregar   '+CHR(24)+' '+CHR(25)+' Seleccionar   '+;
      CHR(17)+CHR(196)+CHR(217)+' Confirmar   <F8> Borrar   <ESC> Terminar'
      ACTI POPUP POPCUENTA
      IF LASTKEY() = -7
         IF CARGOS <> 0 .OR. ABONOS <> 0
            @23,1 SAY SPACE(78)
            @10,20 SAY 'CUENTA TIENE SALDO NO SE PUEDE BORRAR.'
            @11,20 SAY 'CUENTA TIENE SALDO NO SE PUEDE BORRAR..'
            @12,20 SAY 'CUENTA TIENE SALDO NO SE PUEDE BORRAR...'
            @13,20 SAY 'CUENTA TIENE SALDO NO SE PUEDE BORRAR....'
            @14,20 SAY 'CUENTA TIENE SALDO NO SE PUEDE BORRAR.....'
            @23,20 SAY 'CUENTA TIENE SALDO NO SE PUEDE BORRAR......'
            LOOP
         ENDIF
         DELETE
      ENDIF
      XCUENTA = CUENTA
      XSCUENTA = SCUENTA
      XSSCUENTA = SSCUENTA
      XSSSCUENTA = SSSCUENTA
   ENDDO
   @ 23,1 SAY SPACE(78)
   IF LASTKEY() = -1 .OR. LASTKEY() = 27
      LOOP
   ENDIF
   IF XCUENTA = 0
      EXIT
   ENDIF
   SEEK STR(XCUENTA,4)+STR(XSCUENTA,4)+STR(XSSCUENTA,3)+STR(XSSSCUENTA,3)
   IF EOF()
      APPEND BLANK
      REPLACE CUENTA WITH XCUENTA,SCUENTA WITH XSCUENTA,SSCUENTA WITH XSSCUENTA,SSSCUENTA WITH XSSSCUENTA
   ENDIF
   @ 10,15 SAY 'Numero de Cuenta :     ' GET XCUENTA    PICT '9999'
   @ 11,15 SAY 'Numero de S-Cuenta :   ' GET XSCUENTA   PICT '9999'
   @ 12,15 SAY 'Numero de SS-Cuenta :  ' GET XSSCUENTA  PICT '999'
   @ 13,15 SAY 'Numero de SSS-Cuenta : ' GET XSSSCUENTA PICT '999'
   CLEAR GETS
   @ 17,15 SAY 'Nombre : ' GET NOMBRE
   @ 19,15 SAY 'Tipo :   ' GET TIPO PICT '@M ,M'
   @ 23,20 SAY 'ES CORRECTA LA INFORMACION  SI/NO ? ' GET SINO PICT '@M SI,NO'
   READ
   IF SINO <> 'SI'
      IF CARGOS <> 0 .OR. ABONOS <> 0
         WAIT 'CUENTA TIENE SALDO NO SE PUEDE BORRAR' WIND
         LOOP
      ENDIF
      DELETE
   ENDIF
ENDDO
CLOSE DATABASES
RETURN


