*    ESTE REPORTE OBTIENE LOS SALDOS MENSUALES
*
SELECT 1
USE &XPATCB\CUENTA INDEX &XPATCB\CUENTA ALIAS CUENTA
DO WHILE .T.
   @ 4, 1 TO 21,78 CLEAR
   @23, 1 SAY SPACE(78)
   XTITULO = 'REPORTE DE SALDOS MENSUALES'
   SINO    = 'S'
   XDEST   = 'I'
   XCUENTA = 0
   XNIVEL = XCAUXI
   @5,20 SAY XTITULO
   SELECT 1
   ON KEY LABEL F1 DO BCUENTA
   @7,10  SAY 'Teclee el Numero de Cuenta de Mayor : ' GET XCUENTA PICT '9999'
   @23,20 SAY '<F1> Lista          <ESC> Terminar'
   READ
   ON KEY LABEL F1
   IF LASTKEY() = 27
      EXIT
   ENDIF
   @23, 1 SAY SPACE(78)
   @10,10  SAY 'Teclee el Nivel al Cual Quiere los Saldos : ' GET XNIVEL PICT '9'
   @18,20 SAY 'Informacion en <I>mpresora o <T>erminal  ' GET XDEST PICT '@M I,T'
   @23,20 SAY '<ESC> Terminar'
   READ
   IF LASTKEY() = 27
      EXIT
   ENDIF
   @23, 1 SAY SPACE(78)
   SET COLOR TO 7*
   @23,20 SAY 'FAVOR DE ESPERAR UN MOMENTO ....'
   SET COLOR TO &XCOLOR
   SELECT 2
   USE &XPATCB\SALDOS INDEX &XPATCB\SALDOS
   SET RELATION TO CUENTA INTO CUENTA
   IF XCUENTA <> ' '
      SET FILTER TO CUENTA = XCUENTA
      GO TOP
   ENDIF
   IF EOF ()
      WAIT 'NO EXISTE INFORMACION DE LA CUENTA' WIND
      CLOSE DATABASES
      RETURN
   ENDIF
   NPAG  = 0
   N     = NLPP
   XNLPP = NLPP
   SET DEVICE TO PRINT
   IF XDEST = 'T'
      XT=XTERMINAL+'.TXT'
      SET PRINTER TO &XT
   ENDIF
   ??? CHR(15)
   STORE 0 TO XSALDO01,XSALDO02,XSALDO03,XSALDO04,XSALDO05,XSALDO06
   STORE 0 TO XSALDO07,XSALDO08,XSALDO09,XSALDO10,XSALDO11,XSALDO12
   DO WHILE .NOT. EOF()
      IF N>=XNLPP
         NPAG = NPAG + 1
         @0, 1  SAY FFFFFF
         @0,124 SAY 'PAGINA :'
         @0,133 SAY NPAG PICT '999'
         IF XDEST = 'I'
            ??? CHR(18)+CHR(14)
            @1,(44-LEN(XCIA))/2 SAY XCIA
            ??? CHR(15)+CHR(14)
            @2,(70-LEN(XTITULO))/2 SAY XTITULO
         ELSE
            @1,(137-LEN(XCIA))/2 SAY XCIA
            @2,(137-LEN(XTITULO))/2 SAY XTITULO
            XNLPP = 10000
         ENDIF
         @4, 2  SAY 'CUENTA'
         @4,20  SAY 'N O M B R E'
         @4,35  SAY '       ENE/JUL'
         @4,52  SAY '       FEB/AGS'
         @4,69  SAY '       MAR/SEP'
         @4,86  SAY '       ABR/OCT'
         @4,103 SAY '       MAY/NOV'
         @4,120 SAY '       JUN/DIC'
         @5, 1 SAY REPLICATE('=',135)
         N=5
      ENDIF
      YCUENTA = CUENTA
      YNOMBRE = CUENTA->NOMBRE
      N=N+1
      @N,1   SAY YCUENTA
      @N,12  SAY YNOMBRE PICT 'XXXXXXXXXXXXXXXXXXXXXX'
      DO WHILE YCUENTA = CUENTA .AND. .NOT. EOF()
         DO CASE
         CASE PERIODO = 0
              XSALDO01 =XSALDO01+CARGOS-ABONOS
         CASE PERIDO = 1
              XSALDO01 = XSALDO01+CARGOS-ABONOS
         CASE PERIODO = 2
              XSALDO02 = XSALDO02+CARGOS-ABONOS
         CASE PERIODO = 3
              XSALDO03 = XSALDO03+CARGOS-ABONOS
         CASE PERIODO = 4
              XSALDO04 = XSALDO04+CARGOS-ABONOS
         CASE PERIODO = 5
              XSALDO05 = XSALDO05+CARGOS-ABONOS
         CASE PERIODO = 6
              XSALDO06 = XSALDO06+CARGOS-ABONOS
         CASE PERIODO = 7
              XSALDO07 = XSALDO07+CARGOS-ABONOS
         CASE PERIODO = 8
              XSALDO08 = XSALDO08+CARGOS-ABONOS
         CASE PERIODO = 9
              XSALDO09 = XSALDO09+CARGOS-ABONOS
         CASE PERIODO = 10
              XSALDO10 = XSALDO10+CARGOS-ABONOS
         CASE PERIODO = 11
              XSALDO11 = XSALDO11+CARGOS-ABONOS
         CASE PERIODO = 12
              XSALDO12 = XSALDO12+CARGOS-ABONOS
         ENDCASE
         SKIP
      ENDDO
      @N,35  SAY XSALDO01  PICT '9,999,999,999.99'
      @N,52  SAY XSALDO02  PICT '9,999,999,999.99'
      @N,69  SAY XSALDO03  PICT '9,999,999,999.99'
      @N,86  SAY XSALDO04  PICT '9,999,999,999.99'
      @N,103 SAY XSALDO05  PICT '9,999,999,999.99'
      @N,120 SAY XSALDO06  PICT '9,999,999,999.99'
      N = N + 1
      @N,35  SAY XSALDO07  PICT '9,999,999,999.99'
      @N,52  SAY XSALDO08  PICT '9,999,999,999.99'
      @N,69  SAY XSALDO09  PICT '9,999,999,999.99'
      @N,86  SAY XSALDO10  PICT '9,999,999,999.99'
      @N,103 SAY XSALDO11  PICT '9,999,999,999.99'
      @N,120 SAY XSALDO12  PICT '9,999,999,999.99'
      STORE 0 TO XSALDO01,XSALDO02,XSALDO03,XSALDO04,XSALDO05,XSALDO06
      STORE 0 TO XSALDO07,XSALDO08,XSALDO09,XSALDO10,XSALDO11,XSALDO12
      N = N + 1
   ENDDO
   EXIT
ENDDO
EJECT
SET DEVICE TO SCREEN
CLOSE DATABASES
IF XDEST = 'T'
   DO TERMINAL
ENDIF
RETURN
